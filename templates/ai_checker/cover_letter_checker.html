{% extends "base.html" %}
{% load static %}

{% block title %}Cover Letter Checker{% endblock %}

{% block content %}
<div class="container py-4">
    <h1 class="mb-3">Cover Letter Checker</h1>

    <form method="post" enctype="multipart/form-data" id="cover-letter-form" novalidate>
        {% csrf_token %}

        <div class="mb-3">
            <label for="id_job_description" class="form-label">Job Title & Description</label>
            <textarea name="job_description" id="id_job_description" required class="form-control" placeholder="Paste the job description here..">{{ job_description|default_if_none:"" }}</textarea>
            {% if form.cover_letter.errors %}
                <div class="text-danger small">{{ form.cover_letter.errors.as_text }}</div>
            {% endif %}
        </div>

        <div class="mb-3">
            <label for="id_cover_letter" class="form-label">Upload Cover letter (PDF)</label>
            <input type="file" name="cover_letter" id="id_cover_letter" accept="application/pdf" required aria-describedby="pdf-help" class="form-control">
            <div id="pdf-help" class="form-text">Only PDF files are accepted.</div>
            {% if form.pdf.errors %}
                <div class="text-danger small">{{ form.pdf.errors.as_text }}</div>
            {% endif %}
        </div>

        <button type="submit" class="btn btn-primary" id="cover-letter-submit">
            <span class="submit-text">Submit</span>
            <span class="spinner-border spinner-border-sm ms-2 d-none" role="status" aria-hidden="true" id="cover-letter-spinner"></span>
        </button>
    </form>
        <!-- Loading modal shown when the cover letter is being processed -->
        <div class="modal fade" id="cover-letter-loading-modal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content bg-transparent border-0 shadow-none">
                    <div class="modal-body text-center">
                        <div class="spinner-border text-light" role="status" aria-hidden="true" style="width:3rem;height:3rem;"></div>
                        <div class="mt-3 text-white">Processing your cover letter â€” this may take a moment...</div>
                    </div>
                </div>
            </div>
        </div>
</div>
{% endblock %}